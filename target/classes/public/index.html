<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<style>
.getfield{
  height:px;
  width:px;
  overwirte:visible;
  
}
.div_input{
 height:4752px;
 width:1200px;
 position:absolute;
 top:0px;
 left:0px;
 

} 
.inputfield{
 /*  top:50px;
  left:50px;
  height:30px;
  width:100px; */
  padding:0;
  margin:0;
  border:none;            
  position:absolute;
  opacity:1;

}
/* .checkbox{
  padding:0;
  margin:0;
  border:none;            
  position:absolute;
  opacity:1;

} */


.button{
	 z-index: 999;
	 height: 50px;
	 width:100px;

}


/* input::-webkit-calendar-picker-indicator {
	opacity: 100;
} */




</style>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
</head>
<body>
	
	<img class="getfield" src=""/>
	<div class="div_input">  <button class="button"  onclick="GetText()">Save</button> </div>
</body>
<script>
var img = new Image();
img.src = "/ImageSample";



$(document).ready(function(){
			$("img.getfield").attr("src",img.src);
			$("img.getfield").on("load",function(e){
				var wrapper         = $(".div_input");
				var offsetX = this.offsetLeft;
				var offsetY = this.offsetTop;
				
				  imgHeight = img.height;
				  imgWidth = img.width;
				  
				 $.get("/pdf/fields", function(data){
					 console.log(data);
					 for(var i=0;i<data.length;i++){
						 
						 var size = data[i].size;
						 var type = data[i].fieldType;
						
						 
					 	 if(size == 1 && (type == 4 || type ==7)  ){ 
					 		 var imgFieldX = offsetX + data[i].positions[0].xpercent*imgWidth;
							 //console.log(imgFieldX);
							 /* console.log(imgFieldX); */
							 var imgFieldY = offsetY + data[i].positions[0].ypercent*imgHeight;
							 
							 var imgFieldWidth = imgWidth * data[i].positions[0].widthPercent;
							
							 var imgFieldHeight = imgHeight * data[i].positions[0].heightPercent;
					 		
							/* console.log("text"); */
							/* $(wrapper).append('<input class="inputfield" list="field"  name ="' + data[i].name + '"  value ="' + data[i].value + '"  type="text"/>'); */
						 	var x = $('<input class="inputfield" list="field"  fieldType ="' + data[i].fieldType + '" name ="' + data[i].name + '"  value ="' + data[i].value + '"  type="text"/>');
						 	$(wrapper).append(x);					 	
						 	x.css({
						 		width:imgFieldWidth,
						 		height:imgFieldHeight,
						 		top:imgFieldY,
						 		left:imgFieldX						 		
						 	});						
					 	 }		 
					   	  else if(size > 1 && type ==2){
					   		for(var j=0;j<size;j++){
					   		 	imgFieldX = offsetX + data[i].positions[j].xpercent*imgWidth;
							 	//console.log(imgFieldX);
								 /* console.log(imgFieldX); */
								 imgFieldY = offsetY + data[i].positions[j].ypercent*imgHeight;
							 
								 imgFieldWidth = imgWidth * data[i].positions[j].widthPercent;
								
								 imgFieldHeight = imgHeight * data[i].positions[j].heightPercent;
					  								
								var x = $('<input class="inputfield" type="checkbox" isChecked ="' + data[i].isChecked + '" fieldType ="' + data[i].fieldType + '" name ="' + data[i].name + '"  value ="' + data[i].value + '" />');
						 		$(wrapper).append(x);						 	
						 		x.css({
						 			width:imgFieldWidth,
						 			height:imgFieldHeight,
						 			top:imgFieldY,
						 			left:imgFieldX
						 		
						 		});
					   		}
					 	}    
					} 

			      });
			});
			
			$(".div_input").append('<datalist id="field"> </datalist>');
			/*  $(".inputfield").css({ 
				 '-webkit-calendar-picker-indicator':'opacity(1)'
			 }) */
			 //
			 $("#field").append('<option value="chrome" class="dropdownlist"></option>');
			 $("#field").append(	'<option value="firefox"></option>');
			 //
			
	 
			
		 	$(".div_input").on("click",".inputfield",function(){
				$(this).css('opacity','0.5');
				 
				});
			
			$(".div_input").on("blur",".inputfield",function(){
				$(this).css('opacity','1');
				
				}); 
			
			
	});

	
	
function GetText() {
	var input;
	var myJson = [];
	var type;
	
	 $(".inputfield").each(function () {
		input = $(this).val();
		type = $(this).attr("fieldType");
		if($(this).prop('checked') == true){
			
		}
		else if($(this).prop('checked') == false){
			//console.log("unchecked");
		}
		myJson.push({
			
			"type": $(this).attr("fieldType"),
			"name": $(this).attr("name"),
			"value": input
			
		});		
	});

	$.ajax({
		url:"/pdf/fields",
		type:"POST",
		data: JSON.stringify(myJson),
		dataType:"json",
		
		contentType : 'application/json; charset=utf-8',
		success:function(data){
			
			alert("123!");
		}
	});
	
}
</script>
</html>
